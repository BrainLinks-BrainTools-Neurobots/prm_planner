<launch>
	<rosparam command="load" ns="prm_planner" file="$(find prm_planner_launch)/config/iiwa_grasping/params.yaml" />
	<rosparam command="load" ns="prm_planner/problem_definitions" file="$(find prm_planner_launch)/config/iiwa_grasping/problems.yaml" />
	<rosparam command="load" ns="prm_planner/robots" file="$(find prm_planner_launch)/config/iiwa_grasping/robots.yaml" />

	<!-- If needed, broadcast static tf for robot root -->
	<node pkg="tf" type="static_transform_publisher" name="virtual_joint_broadcaster_0" args="0 0 0 0 0 0 iiwa/iiwa_base_link iiwa/interactive_marker_base_link 100" />
	<node pkg="tf" type="static_transform_publisher" name="virtual_joint_broadcaster_1" args="0 0 0 0 0 0 iiwa/iiwa_base_link iiwa/trajectory_base_link 100" />

	<!-- Given the published joint states, publish tf for the robot links -->
	<group ns="iiwa">
		<param name="robot_description" textfile="$(find iiwa_description)/urdf/iiwa_sdh2.urdf" />
		<param name="collision_matrix" type="string" value="$(find iiwa_description)/collision_matrices/iiwa_sdh2.cm" />

		<node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" respawn="true" output="screen">
			<param name="tf_prefix" type="string" value="iiwa" />
		</node>

		<node name="iiwa_publisher" pkg="vrep_interface" type="kuka_iiwa_interface" output="screen" />
		<node name="sdh2_publisher" pkg="vrep_interface" type="kuka_sdh_interface" output="screen">
			<param name="vrep_prefix" type="string" value="iiwa" />
		</node>
	</group>

	<node name="rviz" pkg="rviz" type="rviz" respawn="false" args="-d $(find prm_planner_launch)/rviz/iiwa_grasping.rviz" output="screen" />

	<include file="$(find realtime_urdf_filter)/launch/iiwa_sim.launch" />
</launch>